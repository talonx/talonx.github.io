---           
layout: post
title: Private Cloud Options with Amazon Web Services - Part 1
date: 2013-09-27 17:22:10 UTC
updated: 2013-09-27 17:22:10 UTC
comments: false
categories: amazon web services cloud vpc
---
Amazon Web Services is the largest IaaS provider, according to this <a href="http://blogs.gartner.com/lydia_leong/2013/08/21/the-2013-cloud-iaas-magic-quadrant/" target="_blank">Gartner report</a>, in terms of compute capacity. AWS also has a wider geographical presence than other similar companies.          &nbsp;<br /><br />AWS offers an option to have a private cloud inside their public  cloud. You can run this as a small personal cloud, or use one of  Amazon's connectivity offerings to connect it securely to your existing  infrastructure. This is an overview of the private cloud options with AWS, followed by an overview of the various connectivity options.<br /><br /><b>Private Cloud Options</b><br />When  you launch a regular EC2 instance, it has a public IP address. It is  always reachable from the public internet whether you want it  or not.  You can configure the instance's AWS security group (the inbuilt  firewall) to allow access to specific ports only, but this may not serve  your security needs. You might want traffic to flow only between  your  instances and not from the internet.         <br />The obvious way to do this is to not have IP addresses which are  reachable from the internet, i.e., use private IP addresses. Which is  exactly what <a href="http://aws.amazon.com/vpc/" target="_blank">VPC</a> offers.<br /><div><br /><b>IP Ranges</b><br />A <a href="http://aws.amazon.com/vpc/" target="_blank">VPC</a> is  like a private network inside Amazon's cloud where you can create  smaller subnets and instances inside them. While creating a VPC, you'll  need to define the range of IP addresses that the VPC will cover.    </div><div><br /></div><div><b>Subnets</b>&nbsp;<br />The basic unit of a VPC is a subnet - a logical network where you  can create instances, define the range of private IP addresses that the  instances inside it will have and create routing tables to define how  traffic is routed to and from the subnet.</div><br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-iuRcY2iqTzc/UkW7prZam0I/AAAAAAAAABE/K5xDV6WeIgg/s1600/Screenshot+from+2013-09-27+22:35:07.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="182" src="http://1.bp.blogspot.com/-iuRcY2iqTzc/UkW7prZam0I/AAAAAAAAABE/K5xDV6WeIgg/s320/Screenshot+from+2013-09-27+22:35:07.png" width="320" /></a></div><div></div><div><b>Kinds of Subnets</b></div><div>There are two kinds of subnets you can create inside a VPC</div><div>Private : EC2 instances created inside it cannot talk to the  internet and vice versa.        </div><div>Public : EC2 instances created inside it can access the internet and can also be made accessible from the internet.<br /><br />Private  and public are just names and not inbuilt properties. What actually  makes them "private" and "public" are the routing tables you create and  assign to the subnets. So you must first create the subnets, then create  the tables, assign them to the subnets and finally give them descriptive  names. If you use the VPC wizard, it will do this for you. You can  create multiple subnets of each type.         </div><div><br /></div><div><div><b>Communication between a public subnet and the internet</b></div>If  you want your instances to access the internet, you have an option of  adding an "internet gateway" to a subnet. The internet gateway here is  an AWS abstraction. You would add this to your public subnet (or  subnets). Once you assign a gateway, you must assign an elastic IP to an  instance inside that subnet. This instance is the one that would be  able to communicate with the outside world.</div><div><br />  </div><div><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-UwCxLmNfvaA/UkW8FXW8JtI/AAAAAAAAABM/rHWRLr5063E/s1600/Screenshot+from+2013-09-27+22:35:15.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="151" src="http://3.bp.blogspot.com/-UwCxLmNfvaA/UkW8FXW8JtI/AAAAAAAAABM/rHWRLr5063E/s320/Screenshot+from+2013-09-27+22:35:15.png" width="320" /></a></div><div><br /></div><div>VPC places a  limit on the number of elastic IPs (5). If you have many instances  which need to access the internet, you would put all of them behind a  single instance with an EIP instead of assigning each an EIP, and use  NAT to access the internet from the "hidden" instances.  </div><div><br /><b>Communication between a private and a public subnet</b><u><br /></u></div><div>Setting up communication between a private and a public subnet is a straightforward configuration in the routing table.<br /><u><br /></u>A typical example of using both private and public subnets in a VPC is from the AWS documentation:      </div><div><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-LxFz6GrB8ZI/UkW8MRs5JGI/AAAAAAAAABU/wdAqhNwRt8A/s1600/Screenshot+from+2013-09-27+22:35:20.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="149" src="http://2.bp.blogspot.com/-LxFz6GrB8ZI/UkW8MRs5JGI/AAAAAAAAABU/wdAqhNwRt8A/s320/Screenshot+from+2013-09-27+22:35:20.png" width="320" /></a></div><div></div><div>Here, the database servers are extra-secure inside a private subnet, while the webservers are in the public subnet, as they have to serve traffic to end users.&nbsp;</div><div></div><div><br />The  "private" nature of a VPC is not limited to the network alone.  Inside a VPC, you have the option of launching a regular EC2 instance,  which is a virtual machine on a  host shared with other guest VMs. You  can also choose to launch a dedicated instance - which is a truly  dedicated machine used only by your instance, giving you isolation at the hardware level as well. Costs are <a href="http://aws.amazon.com/dedicated-instances/" target="_blank">slightly higher</a>  for dedicated instances.</div><div></div><div><br />A VPC lets you setup your own private cloud with  isolation at the hardware and the network levels. I'll explore the  various connectivity options between VPCs and your own datacenter in the  next post.</div>