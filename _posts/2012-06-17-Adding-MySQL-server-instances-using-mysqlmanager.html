---           
layout: post
title: Adding MySQL server instances using mysqlmanager
date: 2009-12-07 08:37:00 UTC
updated: 2009-12-07 08:37:00 UTC
comments: false
categories: automation mysql mysqlmanager
---
The MySQL instance manager - <a href="http://dev.mysql.com/doc/refman/5.1/en/instance-manager.html" target="_blank">mysqlmanager</a> - provides a way to manage multiple MySQL server instances on the same installation. All these instances use a common my.cnf file - but each can be configured individually (using the same file). mysqlmanager itself provides a command line interface to control the individual instances.<br/><br/>Part of a sample mysql.cnf with multiple mysql instances<br/><br/><code>[mysqld1]<br/>user    = mysql<br/>datadir = /data/mysql-1<br/>socket  = /tmp/mysql-1.sock<br/>port    = 3306<br/></code><br/><code>[mysqld2]<br/>user    = mysql<br/>datadir = /data/mysql-2<br/>socket  = /tmp/mysql-2.sock<br/>port    = 3307<br/></code><br/>The ability to setup multiple database servers fast is particularly useful in development boxes where fresh DBs need to be created often. In my team, we often need to do this. Every time a new DB has to be setup, we have to go through the steps of creating a datadir, installing the system tables, adding a root password, adding the entries to the my.cnf file and starting the instance using the mysqlmanager shell.<br/><br/>So I whipped up a small Linux shell script which automates this process.<br/><br/><a href="http://code.deepinspace.net/p/add-mysql-instance.sh" target="_blank">Here it is</a>.<br/><br/>It's still in a quite primitive state - but it works!<br/><br/>Usage is simple -<br/><code>add-mysql-instance.sh mysql config-file-location datadir groupname username password instance port instance-name mysqlmanager-user mysqlmanager-password mysqlmanager-socket-file<br/></code><br/>Of course, mysqlmanager has to be running for this to work.<br/><br/>I'll be adding improvements to this script - like the ability to generate a mysql instance name based on existing instances (instance names are usually mysqld1, mysqld2 etc), picking up the user name from the file itself etc.